<ion-view view-title="Month Events History" hide-back-button="true">
    <ion-content>
        <div id='errorMsg' ng-show='noEventsToShow()'>
            <div class='row'>
                <div class='col col-100'>
                    <h2 class="page-title" >{{msg}}</h2>
                </div>
            </div>
        </div>
        <div id="month-table-content" ng-show="!showDayEdit">
            <div class="row">
                <div class="col col-100">
                    <h2 class="page-title" >{{monthName}}</h2>
                </div>
            </div>
            <div class="row">
                <div class="col col-100">
                    <table class="flat-table extended-table">
                        <tr>
                            <th>Day</th>
                            <th>Events</th>
    <!--                        <th>Left hours</th>-->
                        </tr>
                        <tr ng-if="validMonth();"
                            ng-repeat="day in month">
                            <td>{{day.day}}</td>
                            <td><button ng-disabled="day.evts.length < 1" class="button button-block medium-button" 
                                        ng-click="editDayEvents(day)">
                                    View
                                </button>
                            </td>
    <!--                        <td></td>-->
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <div id="monthday-content" ng-show="showDayEdit">
            <div class="row">
                <div class="col-90" style="margin-left: 30%;">
                    <button class="button small-button button-bar-inline" ng-click="unselectDay()">
                    <h1>&larr;</h1></button>
                </div>
            </div>
            <div class="row">
                <div class="col col-100">
                    <h3 class="edition-title">{{monthName}} {{selectedDay.day}}</h3>
                    <h4 class="page-text">Worked: {{selectedDay.workedHours}}</h4>
                    <h4 ng-if="!noExtraHours(selectedDay)" class="page-text">Extra: {{selectedDay.extraHours}}</h4>
                    <h4 ng-if="!noFaltHours(selectedDay)" class="page-text">Fault: {{selectedDay.falthours}}</h4>
                    <table class="flat-table">
                        <tr>
                            <th>Event</th>
                            <th>Time</th>
                            <th></th>
                            <th></th>
                        </tr>
                        <tr
                        ng-repeat="evt in selectedDay.evts">
                            <td>{{evt.type}}</td>
                            <td ng-if="!editing(evt.id)">{{evt.check}}</td>
                            <td style="width:136px; height: 19.500px" data-th="Edit Type" id="evt{{evt.check}}" ng-if="editing(evt.id) && !selectedDayEqualsToday(selectedDay)"><input maxlength="5" ng-change="formatInput(evt.id, evt.check)" class="evt-input" ng-model="evt.check" /></td>
                            <td data-th="Edit Check" ng-if="!editing(evt.id) && !selectedDayEqualsToday(selectedDay)" ><a class="edit-link"><img ng-click="onEdit(evt.id)" class="edit-image" src="img/edit.png" alt="edit" /></a></td>
                            <td data-th="Edit Check" ng-if="editing(evt.id) && !selectedDayEqualsToday(selectedDay)" ><a class="edit-link"><img ng-click="saveEdit(evt.id, selectedDay)" class="edit-image" src="img/save.png" alt="save" /></a></td>  
                            <td>
                                <a class="edit-link" ng-if="editing(evt.id)"><img ng-click="cancelEdition()" class="edit-image" src="img/cancel.png" alt="cancel" /></a>
                                <a class="edit-link" ng-if="!editing(evt.id)"><img ng-click="removeEvt(selectedDay)" class="edit-image" src="img/remove.png" alt="remove" /></a>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </ion-content>
    
    <script id="unselectedWorkload.html" type="text/ng-template">
        <div class="modal">
            <ion-content scroll="false" class="modal-text">
                <div class="row">
                    <div class="col col-80">
                        <span>Select a workload first!</span>
                    </div>
                    <div class="col col-20">
                        <img class="modal-image" src="img/alert.png" alt="alert" />
                    </div>
                </div>
            </ion-content>
        </div>
    </script>
    
</ion-view>